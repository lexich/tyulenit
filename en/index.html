<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Ens | ТюленITь</title><meta name=keywords content><meta name=description content="Ens - ТюленITь"><meta name=author content="lexich"><link rel=canonical href=https://tyulenit.com/en/><meta name=google-site-verification content="G-00G3WYG3BJ"><link crossorigin=anonymous href=/assets/css/stylesheet.d6fcd20a4fb86efa4dfac8ec95da60244cc8871042183da1ef28e3a762ad79c8.css integrity="sha256-1vzSCk+4bvpN+sjsldpgJEzIhxBCGD2h7yjjp2Ktecg=" rel="preload stylesheet" as=style><link rel=icon href=https://tyulenit.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://tyulenit.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://tyulenit.com/favicon-32x32.png><link rel=apple-touch-icon href=https://tyulenit.com/apple-touch-icon.png><link rel=mask-icon href=https://tyulenit.com/apple-touch-icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://tyulenit.com/en/index.xml><link rel=alternate hreflang=en href=https://tyulenit.com/en/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-00G3WYG3BJ"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-00G3WYG3BJ")}</script><meta property="og:url" content="https://tyulenit.com/en/"><meta property="og:site_name" content="ТюленITь"><meta property="og:title" content="Ens"><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:image" content="https://tyulenit.com/seal.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://tyulenit.com/seal.jpg"><meta name=twitter:title content="Ens"><meta name=twitter:description content><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Ens","item":"https://tyulenit.com/en/"}]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://tyulenit.com/ accesskey=h title="ТюленITь (Alt + H)"><img src=https://tyulenit.com/apple-touch-icon.png alt aria-label=logo height=35>ТюленITь</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://tyulenit.com/tags/ title=tags><span>tags</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://tyulenit.com/>Home</a></div><h1>Ens
<a href=/en/index.xml title=RSS aria-label=RSS><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" height="23"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></h1></header><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>using in the upcoming typescript 5.2</h2></header><div class=entry-content><p>In the upcoming TypeScript 5.2, it’s planed to add a very interesting and useful feature called using. Similar functionality already exists in other languages: in C# it’s using, and in Go it’s defer. The main idea is that using allows you to automatically release a resource (by calling a special method for this) after it exits the scope of the block. For example, if we have a method getResource that has implemented the method [Symbol.dispose](), then we can write the following code and the Symbol.dispose method will be executed automatically at the end of the main function, as if this construct were wrapped in a try finally block.
...</p></div><footer class=entry-footer><span title='2023-06-27 12:01:26 +0400 +0400'>June 27, 2023</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;213 words&nbsp;·&nbsp;lexich</footer><a class=entry-link aria-label="post link to using in the upcoming typescript 5.2" href=https://tyulenit.com/en/posts/2023-06-27-using/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Writing an Adapter for Fetch API</h2></header><div class=entry-content><p>It seems that there is no such project that does not need to make requests to the server. And it is always a good idea to write a separate abstraction to describe such communication. This not only adds readability and reusability to the code, but also makes it possible to quickly and efficiently write tests for such functionality.
class NetworkService { constructor(private readonly fetch: typeof fetch) {} getUser: (): Promise&lt;IUser> => this.fetch('/api/user').then(d => d.json()) } function getUsername(api: Pick&lt;NetworkService, 'getUser'>) { return api.getUser().then(user => user.name); } test('getUsername', async () => { const name = await getUsername({ getUser: () => Promise.resolve({ name: 'test' } as IUser) }); expect(name).toBe('test'); }); And for an average project, this approach will be sufficient. But sometimes there are requirements that you need to redefine the fetch itself. For example, in our project, we are developing an extension for the browser and we want to make requests through the serviceWorker. And there is a requirement to reimplement the Fetch API. As we know, fetch returns a Response primitive, for the creation of which you need to pass the ReadableStream as the first argument, and the response characteristics as the second. Thus, we can use the following construction.
...</p></div><footer class=entry-footer><span title='2023-06-19 11:06:32 +0400 +0400'>June 19, 2023</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;437 words&nbsp;·&nbsp;lexich</footer><a class=entry-link aria-label="post link to Writing an Adapter for Fetch API" href=https://tyulenit.com/en/posts/2023-06-19-fetch/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Creating parameterized strings</h2></header><div class=entry-content><p>A task that is found in almost every project is the creation of parameterized strings. Most often, such constructions can be found in routers, but application can be found in many other places. It usually looks something like this:
const postURL = template('{host}/posts/{id}'); const url = postURL({ host: 'http://example.com', id: 1 }); // url === 'http://example.com/posts/id' Implementing such an API is not a big deal. We split the string using a regular expression, substituting real values for variables.
// create regexp for splitting const buildSeparatorVarRx = (start: string, end: string) => new RegExp(`${start}([^${start + end}]+)${end}`); // use brackets as a separator const rx = buildSeparatorVarRx('\\{', '\\}'); export function template(tmpl: T) { const array = tmpl.split(rx); // TTemplateFunction - ??? const fn: TTemplateFunction = args => array.map((item, i) => (i % 2 ? (args as Record)[item] : item)).join('') as any; return fn; } This implementation meets all our needs, but the question remains what is TTemplateFunction? It constructs a function type from a literal string (string literal types) T, which is passed an object whose keys must match the variables from type T. The return value will be a literal string with substituted values from the arguments instead of the variables from T.
...</p></div><footer class=entry-footer><span title='2023-06-04 23:04:41 +0400 +0400'>June 4, 2023</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;774 words&nbsp;·&nbsp;lexich</footer><a class=entry-link aria-label="post link to Creating parameterized strings" href=https://tyulenit.com/en/posts/2023-06-05-template-config/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Java-style DI in TypeScript</h2></header><div class=entry-content><p>At work, we encountered a fairly common architectural problem in our project. We have a set of services that depend on each other. Initially, the relationships between the services were described using DI through the constructor.
interface Options { service1: Service1; service2: Service2; serviceN: ServiceN; } class ServiceNew { constructor(private options: Options) {} } In most cases, this approach is quite effective. However, sometimes there are situations, for example, when two services depend on each other and you have to inject the dependency through getter functions.
...</p></div><footer class=entry-footer><span title='2023-05-31 12:55:03 +0400 +0400'>May 31, 2023</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;399 words&nbsp;·&nbsp;lexich</footer><a class=entry-link aria-label="post link to Java-style DI in TypeScript" href=https://tyulenit.com/en/posts/2023-05-31-injector/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>The Subscriber Pattern in MobX</h2></header><div class=entry-content><p>The last time I wrote about createAtomSubscriber and told you about its extreme usefulness. I propose to write a Subscriber primitive for reactive subscription/unsubscription/resubscription to data sources. Let’s start with an example of using such a construction.
Imagine that we have a receiveData function that generates data after passing it a text id and a reactive variable $id. Using Subscriber we will create a reactive subscription. When getId returns a value other than undefined and subscriber.data is under observation, receiveData will be started and, using push, we will save the last received value. When the value returned by getId changes (it is important that it is reactive), the subscription will be canceled. If the new value is not undefined, then a resubscription will occur. When subscriber.data goes out of observation, an unsubscription always occurs, regardless of getId.
...</p></div><footer class=entry-footer><span title='2023-05-22 12:53:38 +0400 +0400'>May 22, 2023</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;455 words&nbsp;·&nbsp;lexich</footer><a class=entry-link aria-label="post link to The Subscriber Pattern in MobX" href=https://tyulenit.com/en/posts/2023-05-22-subscriber/></a></article><footer class=page-footer><nav class=pagination><a class=next href=https://tyulenit.com/en/page/2/>Next&nbsp;&nbsp;»</a></nav></footer></main><footer class=footer><span>&copy; 2024 <a href=https://tyulenit.com/>ТюленITь</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>